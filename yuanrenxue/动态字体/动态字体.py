# -*- coding: utf-8 -*-
# @Time   : 2021/4/11 下午9:11
# @Author : wu
"""
pip install fonttools
"""
import base64
import requests
from fontTools.ttLib import TTFont

cipher_map = {
    10100100100101010010010010: 0,
    1001101111: 1,
    100110101001010101011110101000: 2,
    10101100101000111100010101011010100101010100: 3,
    111111111111111: 4,
    1110101001001010110101010100101011111: 5,
    10101010100001010111010101101010010101000: 6,
    1111111: 7,
    101010101101010001010101101010101010010010010101001000010: 8,
    10010101001110101011010101010101000100100: 9,
    111: 11
}


def write_woff(font, file='test'):
    b = base64.b64decode(font)

    with open(file + '.ttf', 'wb') as f:
        f.write(b)

    font = TTFont(file + '.ttf')
    font.saveXML(f'{file}.xml')
    # content = parse(f'{file}.xml')
    # bestcmap = font['cmap'].getBestCmap()
    # print(bestcmap)
    glyf = font['glyf'].glyphs
    for key, value in glyf.items():
        k = list(value.flags)
        y = ''.join([str(i) for i in list(value.flags)])
        # print(y)
        print(key, cipher_map[int(y)])
    print(glyf)


def make_request(page=1):
    url = f'http://match.yuanrenxue.com/api/match/7?page={page}'
    headers = {
        'Accept': 'application/json, text/javascript, */*; q=0.01',
        'Accept-Encoding': 'gzip, deflate',
        'Accept-Language': 'zh-CN,zh;q=0.9',
        'Cache-Control': 'no-cache',
        'Connection': 'keep-alive',
        'Host': 'match.yuanrenxue.com',
        'Pragma': 'no-cache',
        'Referer': 'http://match.yuanrenxue.com/match/7',
        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36',
        'X-Requested-With': 'XMLHttpRequest',
    }
    res = requests.get(url=url, headers=headers)
    write_woff(res.json()['woff'])

    print(res.text)


if __name__ == '__main__':
    # make_request()
    font = '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'
    write_woff(font, 'test')
